# 一、概念和介绍

变分推断（Variational Inference, VI）是一种通过**函数空间优化**近似复杂概率分布的方法，核心思想是用简单的参数化分布族逼近难以解析的后验分布。

通常有以下步骤：

- **定义变分分布**：选择一个简单的分布来近似后验分布。
- **优化变分参数**：通过最大化变分下界（ELBO）来优化变分分布的参数。
- [**推断隐变量**：利用优化后的变分分布进行推断。](https://zhuanlan.zhihu.com/p/1893801387277648020)



[用变分推断统一理解生成模型（VAE、GAN、AAE、ALI） - 科学空间|Scientific Spaces](https://spaces.ac.cn/archives/5716)

$$
p(z|x) = \frac{p(x, z)}{p(x)}
\\= \frac{p(x|z)p(z)}{p(x)}
$$
后验分布： $p(z|x)$

先验分布： $p(z)$

似然分布： $p(x|z)$

边缘分布： $p(x)$



# 二、边缘分布

设 $p(z)$ 是 $p(x)$ 的后验分布，则边缘分布 = $\mathbb{E}_{z\sim p(z)}[p(x|z)]$ =  $p(x) = \int_zp(x|z)p(z)dz$ ，积分意义表示对所有可能的 $z$ 求加权平均，权重由 $p(z)$ 决定。简单说就是 $p(x|z)$ 这坨东西在 $p(z)$ 的概率下的均值。

涉及到积分计算时，低维数据的积分可以直接计算，而高维积分通常用近似方法计算，包括变分推断、马尔科夫链蒙特卡洛MCMC等。

为什么高维积分难以计算？对广义的立方体，积分等于各边长之积。而对高维数据，就是很多边长的积，容易出现数值爆炸或接近0。比如边长为2的512维立方体，积分就是 $2^{512}$ ，不仅数值爆炸，计算复杂度也高。

